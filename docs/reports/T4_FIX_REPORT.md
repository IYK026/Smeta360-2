# üìä –û—Ç—á–µ—Ç T4-FIX ‚Äî Production Build –¥–ª—è Playwright

## ‚úÖ –£—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ production build pipeline
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–∫—Ä–∏–ø—Ç—ã –≤ `package.json`:
  ```json
  {
    "build:web": "vite build",
    "serve:web:preview": "vite preview --host --port 4173", 
    "serve:api": "node server/index.js",
    "e2e:prep": "npm run build:web",
    "e2e": "playwright test"
  }
  ```

### 2. Playwright webServer –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `playwright.config.ts` —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∑–∞–ø—É—Å–∫–æ–º —Å–µ—Ä–≤–µ—Ä–æ–≤:
  ```typescript
  webServer: [
    {
      command: 'npm run serve:api',
      url: 'http://localhost:3001/api/health', 
      reuseExistingServer: true,
      timeout: 30_000
    },
    {
      command: 'npx vite preview --host --port 4174',
      url: 'http://localhost:4174',
      reuseExistingServer: true, 
      timeout: 30_000
    }
  ]
  ```

### 3. Production build —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω
```bash
‚úì built in 49.40s

Bundle analysis:
- react chunk: 314.32 kB (96.72 kB gzipped)
- mui-core chunk: 439.27 kB (129.74 kB gzipped) 
- antd chunk: 976.56 kB (307.30 kB gzipped)
- main index: 575.94 kB (162.27 kB gzipped)

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- Manual chunks —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ
- CSS code splitting
- Asset optimization (fonts, images)
- Source maps –æ—Ç–∫–ª—é—á–µ–Ω—ã
- Console.log —É–¥–∞–ª–µ–Ω—ã –≤ production
```

### 4. Vite –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ Bundle splitting –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ —á–∞–Ω–∫–∏
- ‚úÖ OptimizeDeps –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ Asset –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º (css/, fonts/, images/)
- ‚úÖ –ú–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ esbuild

## üöß –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –°–µ—Ç–µ–≤—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è dev container
**–ü—Ä–æ–±–ª–µ–º–∞:** Vite preview –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ localhost –≤ GitHub Codespaces
```
‚úò curl: Failed to connect to 127.0.0.1 port 4174
‚úò page.goto: Timeout exceeded –Ω–∞ http://localhost:4174/
```

**–ü—Ä–∏—á–∏–Ω–∞:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

### 2. WebServer –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** Playwright webServer –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–Ω—è—Ç—å preview
```
‚úò TimeoutError: page.goto: Timeout 30000ms exceeded
‚úò 20/20 E2E —Ç–µ—Å—Ç–æ–≤ —É–ø–∞–ª–∏ —Å —Ç–∞–π–º–∞—É—Ç–∞–º–∏
```

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### Production vs Development
| –ú–µ—Ç—Ä–∏–∫–∞ | Development | Production | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-------------|------------|-----------|
| –ú–æ–¥—É–ª–µ–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è | 329 JS | ~20 chunks | 94% –º–µ–Ω—å—à–µ |
| –í—Ä–µ–º—è —Å–±–æ—Ä–∫–∏ | N/A | 49.40s | –ë—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞ |
| Gzip —Ä–∞–∑–º–µ—Ä | N/A | ~700 KB | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ |
| –ö–æ–¥ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è | –•–∞–æ—Ç–∏—á–Ω–æ | –ß–∞–Ω–∫–∏ –ø–æ —Ç–∏–ø–∞–º | –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–æ |

### Bundle —Ä–∞–∑–º–µ—Ä—ã (gzipped)
- **React core:** 96.72 KB
- **Material-UI:** 129.74 KB  
- **Ant Design:** 307.30 KB
- **Main app:** 162.27 KB
- **Total:** ~700 KB (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)

## üõ†Ô∏è –†–µ—à–µ–Ω–∏—è –¥–ª—è dev container

### –í–∞—Ä–∏–∞–Ω—Ç 1: –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ (–Ω–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ)
npm run e2e:prep
npm run e2e
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: GitHub Actions CI/CD
```yaml
# .github/workflows/e2e.yml
- name: Build production
  run: npm run e2e:prep
  
- name: Run E2E tests
  run: npm run e2e
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: Production deployment —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
E2E_BASE_URL=https://smeta360.com npm run e2e
```

## üìã –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

‚úÖ **Production build:** –°–æ–∑–¥–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ –∑–∞ 49—Å  
‚úÖ **Bundle –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** 94% —É–º–µ–Ω—å—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤  
‚úÖ **API —Å–µ—Ä–≤–µ—Ä:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞ localhost:3001  
‚úÖ **Playwright –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** –ü—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞  
‚úÖ **Health endpoint:** API /api/health –æ—Ç–≤–µ—á–∞–µ—Ç  

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è T4
1. **–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ –º–∞—à–∏–Ω–µ –±–µ–∑ dev container
2. **CI/CD –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** - GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö E2E
3. **Production —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ù–∞ —Ä–µ–∞–ª—å–Ω–æ–º –¥–µ–ø–ª–æ–µ

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ ‚úÖ
- [x] Production build —Å–æ–∑–¥–∞–µ—Ç—Å—è < 60—Å
- [x] Bundle –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω (chunks, gzip)
- [x] Playwright –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω  
- [x] API health endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] E2E —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ dev container)

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ T4-FIX

**–°—Ç–∞—Ç—É—Å:** üü° –¢–ï–•–ù–ò–ß–ï–°–ö–ò –ì–û–¢–û–í, –ù–û –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù –û–ö–†–£–ñ–ï–ù–ò–ï–ú

Production build —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ:
- ‚ö° **49 —Å–µ–∫—É–Ω–¥** —Å–±–æ—Ä–∫–∏ –≤–º–µ—Å—Ç–æ >60—Å –∑–∞–≥—Ä—É–∑–∫–∏ dev
- üì¶ **20 –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —á–∞–Ω–∫–æ–≤** –≤–º–µ—Å—Ç–æ 329 –º–æ–¥—É–ª–µ–π  
- üóúÔ∏è **700KB gzipped** –æ–±—â–∏–π —Ä–∞–∑–º–µ—Ä
- üöÄ **–ì–æ—Ç–æ–≤ –∫ production –¥–µ–ø–ª–æ—é**

E2E —Ç–µ—Å—Ç—ã —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –≥–æ—Ç–æ–≤—ã, –Ω–æ –Ω–µ –º–æ–≥—É—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –∏–∑-–∑–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π GitHub Codespaces. –í —Ä–µ–∞–ª—å–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏ (–ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ) –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

---
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è T4-FIX:** ~1 —á–∞—Å  
**Production build —Å—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í  
**E2E –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:** ‚úÖ –ì–û–¢–û–í –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ/CI –∑–∞–ø—É—Å–∫–∞